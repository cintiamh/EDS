// Generated by CoffeeScript 1.6.2
(function() {
  var game, ship;

  window.Game = {
    WIDTH: 800,
    HEIGHT: 600,
    NUM_STARS: 200,
    SHIP_MAX_VEL: 4,
    SHIP_DRAG: 0.01,
    BULLET_SPEED: 5
  };

  ship = null;

  game = null;

  document.onkeydown = function(event) {
    switch (event.keyCode) {
      case 37:
      case 65:
        ship.setRotation(-1);
        break;
      case 38:
      case 87:
        ship.setAcceleration(.2);
        break;
      case 39:
      case 68:
        ship.setRotation(1);
        break;
      case 40:
      case 83:
        console.log('down');
        break;
      case 32:
        ship.createBullet(game.shipLayer);
        break;
      default:
        ship.endThrust();
    }
    return event.preventDefault();
  };

  document.onkeyup = function(event) {
    switch (event.keyCode) {
      case 38:
      case 87:
        return ship.endThrust();
      case 37:
      case 65:
        return ship.setRotation(0);
      case 39:
      case 68:
        return ship.setRotation(0);
    }
  };

  window.onload = function() {
    var anim_loop, imageObj;

    imageObj = new Image();
    imageObj.src = 'images/double_ship.png';
    game = new Game.Main(Game.WIDTH, Game.HEIGHT);
    game.createBackground();
    game.createStars(Game.NUM_STARS);
    imageObj.onload = function() {
      ship = new Game.Ship(Game.WIDTH / 2, Game.HEIGHT / 2, imageObj);
      game.shipLayer.add(ship.ship_obj);
      ship.ship_obj.start();
      return console.log(ship.ship_obj.getOffset());
    };
    game.start();
    anim_loop = new Kinetic.Animation(function(frame) {
      var frameRate, time, timeDiff;

      time = frame.time;
      timeDiff = frame.timeDiff;
      frameRate = frame.frameRate;
      if (ship) {
        ship.moveShip();
        ship.rotate(frame);
        ship.fixPosition();
        ship.moveBullets();
        return ship.checkBullets();
      }
    }, game.shipLayer);
    return anim_loop.start();
  };

}).call(this);
